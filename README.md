# ColdDream Travel App (寒梦旅游)

这是一个基于 **.NET 8 Web API** 和 **Uni-app (Vue 3 + TypeScript)** 开发的全栈旅游预约系统。旨在提供流畅的旅游路线浏览、管家预约、攻略分享及积分商城体验。

## 🛠 技术栈

### 后端 (Backend)
- **框架**: .NET 8 Web API
- **数据库**: SQL Server (Entity Framework Core)
- **缓存**: Redis (用于排行榜和热点数据)
- **认证**: JWT (JSON Web Token), 微信小程序登录
- **日志**: Serilog
- **API 文档**: Swagger / OpenAPI

### 前端 (Frontend)
- **框架**: Uni-app (支持 H5, 微信小程序, App)
- **核心库**: Vue 3 (Composition API), TypeScript
- **构建工具**: Vite
- **状态管理**: Pinia
- **样式**: SCSS
- **网络请求**: 封装的 Promise 请求库 (支持拦截器)

## ✨ 主要功能

### 1. 用户系统
- **注册/登录**: 支持账号密码登录、微信一键授权登录、游客模式 (Guest Login)。
- **个人中心**:
  - 显示用户头像、昵称、积分、会员等级。
  - **编辑资料**: 支持修改头像 (上传) 和昵称。
  - **系统设置**: 账号安全、消息通知、通用设置、退出登录。
- **积分体系**: 注册、发布攻略、预订均可获得积分，积分可用于商城兑换。

### 2. 旅游服务
- **路线浏览**: 精选旅游路线展示，支持按价格、热度排序。
- **路线详情**: 包含行程介绍、费用说明、预订须知。
- **私密路线**: 特定路线仅限特定等级用户或通过密码访问。
- **管家服务**: 浏览金牌管家，查看管家详情并进行预约。
- **在线预订**:
  - 选择路线、日期、出行人数。
  - **优惠券**: 下单时可选择可用优惠券抵扣金额。
  - 订单管理 (全部、待支付、已完成、已取消)。

### 3. 内容社区 (攻略/灵感)
- **攻略分享**: 用户可发布图文攻略，支持**上传封面图片**。
- **灵感发现**: 瀑布流展示用户发布的精彩瞬间。
- **互动**: 点赞、收藏功能。

### 4. 营销活动
- **优惠券系统**:
  - 用户可领取优惠券 (测试券)。
  - 订单结算时自动计算折扣。
- **积分商城**: 使用积分兑换周边商品或虚拟服务。
- **排行榜**: 展示活跃用户或热门路线排行。

### 5. 其他功能
- **联系客服**: 一键拨打客服电话。
- **动态轮播图**: 首页顶部展示热门活动。
- **图片上传**: 支持本地图片上传至服务器 (HTTPS)。

## 🚀 快速开始

### 后端启动
1. 进入 `ColdDream.Api` 目录。
2. 配置 `appsettings.json` 中的数据库连接字符串 (`DefaultConnection`) 和 Redis 连接 (`Redis`)。
3. 运行数据库迁移:
   ```bash
   dotnet ef database update
   ```
4. 启动服务:
   ```bash
   dotnet run
   ```
   *服务默认运行在 `https://localhost:7282` 和 `http://localhost:5116`*

### 前端启动
1. 进入 `ColdDream.UniApp` 目录。
2. 安装依赖:
   ```bash
   npm install
   ```
3. 启动 H5 开发服务器:
   ```bash
   npm run dev:h5
   ```
4. 或在 HBuilderX 中打开项目运行到微信小程序模拟器。

## 📂 目录结构

```
ColdDream/
├── ColdDream.Api/          # .NET 8 后端项目
│   ├── Controllers/        # API 控制器
│   ├── Models/             # 实体模型
│   ├── Services/           # 业务逻辑层
│   ├── Data/               # 数据库上下文
│   └── wwwroot/            # 静态文件 (上传的图片等)
│
├── ColdDream.UniApp/       # Uni-app 前端项目
│   ├── src/
│   │   ├── api/            # API 接口封装
│   │   ├── pages/          # 页面文件
│   │   ├── static/         # 静态资源
│   │   ├── stores/         # Pinia 状态管理
│   │   └── utils/          # 工具函数
│   └── pages.json          # 页面路由配置
│
└── README.md               # 项目说明文档
```

## 📝 最近更新
- **2026-01-08**:
  - 新增 **优惠券系统** (后端模型 + 前端领取与使用)。
  - 完善 **个人中心** (编辑资料、系统设置、退出登录)。
  - 实现 **图片上传** 功能 (攻略封面上传)，修复 HTTPS 兼容性问题。
  - 新增 **联系客服** 页面。

## ⚠️ 注意事项
- 本项目后端开启了静态文件服务 (`UseStaticFiles`) 以支持图片访问。
- 前后端交互已配置 CORS 允许跨域。
- 微信小程序开发时，请确保后端启用 HTTPS，并在开发者工具中开启"不校验合法域名" (开发阶段)。

---
Copyright © 2026 ColdDream. All Rights Reserved.
